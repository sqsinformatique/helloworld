(this.webpackJsonphelloworld=this.webpackJsonphelloworld||[]).push([[0],{191:function(e,t,a){e.exports=a(300)},290:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},293:function(e,t,a){},300:function(e,t,a){"use strict";a.r(t);a(192),a(218),a(220),a(221),a(223),a(224),a(225),a(226),a(227),a(228),a(229),a(230),a(232),a(233),a(234),a(235),a(236),a(237),a(238),a(239),a(240),a(241),a(243),a(244),a(245),a(246),a(247),a(248),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(259),a(260);var r=a(0),n=a.n(r),o=a(122),s=a.n(o),i=a(28),c=a.n(i),l=a(10),u=a.n(l),d=a(29),h=a(22),m=a(23),p=a(54),f=a(25),b=a(24),v=a(2),g=a(134),E=a.n(g),_=(a(279),a(124)),k=a.n(_),y=a(125),j=a.n(y),O=a(126),C=a.n(O),w=a(87),S=a.n(w),x=a(66),P=a.n(x),U=["friends","client","courier"],q=(a(280),a(49)),z=a.n(q),G=a(55),T=a.n(G),V=a(43),I=a.n(V),M=a(67),N=a.n(M),W=a(129),B=a.n(W),F=a(127),A=a.n(F),D=a(128),K=a.n(D),J=function(e){var t=e.id,a=e.go;e.fetchedUser;return n.a.createElement(z.a,{id:t},n.a.createElement(T.a,null,"\u0413\u0434\u0435 \u043a\u0443\u0440\u044c\u0435\u0440?"),n.a.createElement(I.a,{title:"Navigation Example"},n.a.createElement(B.a,null,n.a.createElement(N.a,{expandable:!0,before:n.a.createElement(A.a,null),onClick:a,"data-to":"client"},"\u042f \u043a\u043b\u0438\u0435\u043d\u0442"),n.a.createElement(N.a,{expandable:!0,before:n.a.createElement(K.a,null),onClick:a,"data-to":"courier"},"\u042f \u043a\u0443\u0440\u044c\u0435\u0440"),n.a.createElement(N.a,{expandable:!0,before:n.a.createElement(P.a,null),onClick:a,"data-to":"business"},"\u042f \u0431\u0438\u0437\u043d\u0435\u0441"))))},L=a(30),R=a.n(L),Z=a(31),H=a.n(Z),Y=a(32),$=a.n(Y),Q=a(130),X=a.n(Q),ee=a(131),te=a.n(ee),ae=a(132),re=a.n(ae),ne=(a(290),Object(v.w)());ne===v.k&&ne===v.a||(n.a.Fragment,R.a,X.a,R.a,te.a,R.a,re.a);var oe=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={fetchedUser:null},r}return Object(m.a)(a,[{key:"getClientOrders",value:function(){return[{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438"',date:"06.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"5488779",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:123},{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0410\u0432\u0442\u043e\u0437\u0430\u043f\u0447\u0430\u0441\u0442\u0438"',date:"08.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"34643-643",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:124}]}},{key:"render",value:function(){var e=this.props;return n.a.createElement(z.a,{id:e.id},n.a.createElement(v.o,{left:n.a.createElement(R.a,{onClick:e.go,"data-to":"home"},ne===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},"\u041a\u043b\u0438\u0435\u043d\u0442"),n.a.createElement(I.a,{header:n.a.createElement(v.j,null,"\u041c\u043d\u0435 \u0432\u0435\u0437\u0443\u0442")},this.getClientOrders().map((function(t){return n.a.createElement(v.q,{disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:t.shop,caption:t.date,after:t.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,{onClick:function(a){return e.go(a,t)},"data-to":"view_where_courier"},"\u041a\u0443\u0440\u044c\u0435\u0440 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435"),n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"))},t.number)}))))}}]),a}(n.a.Component),se=a(59),ie=a.n(se),ce=(a(291),Object(v.w)()),le=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={fetchedUser:null},r}return Object(m.a)(a,[{key:"getBusinessOrders",value:function(){return[{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438"',date:"06.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"5488779",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:123,courier_name:"\u0418\u0432\u0430\u043d\u043e\u0432 \u0412\u0438\u043a\u0442\u043e\u0440"},{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0410\u0432\u0442\u043e\u0437\u0430\u043f\u0447\u0430\u0441\u0442\u0438"',date:"08.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"34643-643",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:124,courier_name:"\u0420\u0430\u0432\u0448\u0430\u043d \u0418\u043b\u044c\u044e\u0441\u043e\u0432\u0438\u0447"}]}},{key:"render",value:function(){var e=this.props;return n.a.createElement(z.a,{id:e.id},n.a.createElement(T.a,{left:n.a.createElement(R.a,{onClick:e.go,"data-to":"home"},ce===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},"\u0411\u0438\u0437\u043d\u0435\u0441"),n.a.createElement(I.a,{header:n.a.createElement(ie.a,null,"\u0423 \u043a\u0443\u0440\u044c\u0435\u0440\u0430")},this.getBusinessOrders().map((function(t){return n.a.createElement(v.q,{key:t.number,disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:"\u041a\u0443\u0440\u044c\u0435\u0440 "+t.courier_name,caption:t.date,after:t.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,{onClick:function(a){return e.go(a,t)},"data-to":"view_where_courier_for_business"},"\u041a\u0443\u0440\u044c\u0435\u0440 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435"),n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"))},t.number)}))))}}]),a}(n.a.Component),ue=a(88),de=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).addCourier=function(){r.setState({validatePhone:r.isValidPhone(r.state.phone)}),r.state.validatePhone&&r.createBinding(),r.getMyCuriers()},r.updatePhoneValue=function(e){r.setState({phone:e.target.value}),console.log(r.state.phone)},r.resetPhoneValue=function(e){e.target.value=""},r.state={fetchedUser:null,validatePhone:!0,user:e.user,phone:"",couriers:null},r}return Object(m.a)(a,[{key:"getMyCuriers",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,"https://sqsinformatique-vk-back.ngrok.io/api/v1/business/curiers/",e.next=4,fetch("https://sqsinformatique-vk-back.ngrok.io/api/v1/business/curiers/"+t.user.business_id);case 4:return a=e.sent,e.next=7,a.json();case 7:r=e.sent,this.setState({couriers:r.result});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getMyCuriers();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isValidPhone",value:function(e){var t=e.replace(/\D/g,"");return/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(t)}},{key:"createBinding",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a={business_id:t.user.business_id,phone:this.state.phone},console.log(a),"https://sqsinformatique-vk-back.ngrok.io/api/v1/business/bind_curier",e.next=6,fetch("https://sqsinformatique-vk-back.ngrok.io/api/v1/business/bind_curier",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(a)});case 6:(r=e.sent).ok&&(n=r.json(),console.log(n));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unbind",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,r,n,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props,r={business_id:a.user.business_id,curier_id:t},console.log(r),"https://sqsinformatique-vk-back.ngrok.io/api/v1/business/unbind_curier",e.next=6,fetch("https://sqsinformatique-vk-back.ngrok.io/api/v1/business/unbind_curier",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r)});case 6:(n=e.sent).ok&&(o=n.json(),console.log(o));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this,a=this.props;return this.state.validatePhone||(e=n.a.createElement(v.h,{header:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",mode:"error"},"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u043e\u043c\u0435\u0440 \u0432 \u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435")),n.a.createElement(v.n,{id:a.id},n.a.createElement(v.o,null,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"),this.state.couriers&&n.a.createElement(v.i,{header:n.a.createElement(v.j,{mode:"secondary"},"\u041c\u043e\u0438 \u043a\u0443\u0440\u044c\u0435\u0440\u044b")},n.a.createElement(v.m,null,this.state.couriers.map((function(e,a){return n.a.createElement(v.e,{key:e.curier_id,removable:!0,onRemove:function(){t.setState({couriers:[].concat(Object(ue.a)(t.state.couriers.slice(0,a)),Object(ue.a)(t.state.couriers.slice(a+1)))}),t.unbind(e.curier_id)}},e.first_name," ",e.last_name)})))),n.a.createElement(v.g,null,e,n.a.createElement(v.l,{id:"telephone",top:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0443\u0440\u044c\u0435\u0440\u0430 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",onFocus:this.resetPhoneValue,value:"+7123456789",onChange:this.updatePhoneValue}),n.a.createElement(v.d,{size:"xl",onClick:this.addCourier},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}}]),a}(n.a.Component),he=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={fetchedUser:e.fetchedUser},r}return Object(m.a)(a,[{key:"createUser",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,r,n,o,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a="https://sqsinformatique-vk-back.ngrok.io/api/v1/",e.t0=t.userType,e.next="client"===e.t0?5:"courier"===e.t0?7:"business"===e.t0?9:11;break;case 5:return a+="clients",e.abrupt("break",12);case 7:return a+="curiers",e.abrupt("break",12);case 9:return a+="business",e.abrupt("break",12);case 11:return e.abrupt("return",!0);case 12:return e.next=14,c.a.send("VKWebAppGetPhoneNumber",{});case 14:return r=e.sent,console.log(r),e.next=18,c.a.send("VKWebAppGetEmail",{});case 18:return n=e.sent,console.log(n),o={social_id:this.state.fetchedUser.id.toString(),email:n.email,telephone:r.phone_number},e.next=23,fetch(a,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(o)});case 23:(s=e.sent).ok&&(i=s.json(),console.log(i)),t.closePopout();case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this,a=this.props;switch(a.userType){case"client":e="\u043a\u043b\u0438\u0435\u043d\u0442";break;case"courier":e="\u043a\u0443\u0440\u044c\u0435\u0440";break;case"business":e="\u0431\u0438\u0437\u043d\u0435\u0441-\u043f\u0430\u0440\u0442\u043d\u0451\u0440"}return n.a.createElement(v.b,{actions:[{title:"\u042f \u0441\u043e\u0433\u043b\u0430\u0441\u0435\u043d",autoclose:!0,action:function(){return t.createUser()}},{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"}],onClose:a.closePopout},n.a.createElement("h1",null,"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435!"),"\u0412\u044b \u043d\u043e\u0432\u044b\u0439 ",n.a.createElement("b",null,e)," \u043d\u0430\u0448\u0435\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f!",n.a.createElement("div",null,n.a.createElement("br",null),"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435, \u0447\u0442\u043e \u0434\u0430\u0451\u0442\u0435 \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u0435, \u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u0430\u0448\u0435\u0439 \u0443\u0447\u0451\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 \u0412\u041a. ",n.a.createElement("br",null),"\u0414\u0430\u043d\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u0440\u0435\u0442\u044c\u0438\u043c \u043b\u0438\u0446\u0430\u043c. \u041c\u044b \u0445\u0440\u0430\u043d\u0438\u043c \u0442\u043e\u043b\u044c\u043a\u043e ID \u0432 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 \u0438 \u043c\u044b \u043d\u0435 \u0445\u0440\u0430\u043d\u0438\u043c \u0412\u0430\u0448 email \u0438 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440."))}}]),a}(n.a.Component),me=(a(292),Object(v.w)()),pe=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={fetchedUser:null},r}return Object(m.a)(a,[{key:"getCourierOrders",value:function(){return[{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438"',date:"06.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"5488779",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:123},{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0410\u0432\u0442\u043e\u0437\u0430\u043f\u0447\u0430\u0441\u0442\u0438"',date:"08.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"34643-643",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:124}]}},{key:"render",value:function(){var e=this.props;return n.a.createElement(v.n,{id:e.id},n.a.createElement(v.o,{noShadow:!0,left:n.a.createElement(v.p,{onClick:e.go,"data-to":"home"},me===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},"\u041a\u0443\u0440\u044c\u0435\u0440"),n.a.createElement(I.a,{header:n.a.createElement(ie.a,null,"\u041c\u043d\u0435 \u0432\u0435\u0437\u0443\u0442")},this.getCourierOrders().map((function(t){return n.a.createElement(v.q,{disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:t.shop,caption:t.date,after:t.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,{onClick:function(a){return e.go(a,t)},"data-to":"view_where_client"},"\u0410\u0434\u0440\u0435\u0441 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435"),n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c"))},t.number)}))))}}]),a}(n.a.Component),fe=a(27),be={center:[55.751574,37.573856],zoom:9,controls:["zoomControl"]},ve=Object(v.w)();var ge=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={courier_id:-1,courier_geodata:{lat:55.6592,long:37.753314}},r.state.geoUpdateInterval=setInterval((function(){r.fetchCourierGeo()}),5e3),r}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,this.setState({courier_id:t.order.courier_id}),this.setState({courier_geodata:{lat:55.6592,long:37.753314}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchCourierGeo",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.courier_id>0&&this.setState({courier_geodata:{lat:this.state.courier_geodata.lat+1e-5,long:this.state.courier_geodata.long+1e-5}});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props;return n.a.createElement(v.n,{id:e.id},n.a.createElement(v.o,{left:n.a.createElement(R.a,{onClick:this.props.go,"data-to":"client"},ve===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},e.order.shop),n.a.createElement(v.q,{disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:"",caption:e.order.date,after:e.order.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"))},e.order.number),function(e,t){var a,r;return a="object"===typeof e?e.lat+","+e.long:e,r="object"===typeof t?t.lat+","+t.long:t,console.log(t),n.a.createElement(fe.d,{query:{apikey:"482da132-c4be-476f-95ef-79ba61d579a4",load:"control.ZoomControl"}},n.a.createElement(fe.a,{width:"100vw",height:"100vh",defaultState:be,className:"mapview"},n.a.createElement(fe.c,{instanceRef:function(e){e&&(e.routePanel.state.set({fromEnabled:!1,type:"masstransit",from:r,to:a,toEnabled:!1}),e.routePanel.options.set({allowSwitch:!1,reverseGeocoding:!0,types:{masstransit:!1,pedestrian:!1,taxi:!1}}))},options:{float:"right"}})))}(e.order.target,this.state.courier_geodata))}}]),a}(n.a.Component),Ee={center:[55.751574,37.573856],zoom:9,controls:["zoomControl"]},_e=Object(v.w)();var ke=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={courier_id:-1,courier_geodata:{lat:55.6592,long:37.753314}},r.state.geoUpdateInterval=setInterval((function(){r.fetchCourierGeo()}),5e3),r}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,this.setState({courier_id:t.order.courier_id}),this.setState({courier_geodata:{lat:55.6592,long:37.753314}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchCourierGeo",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.courier_id>0&&this.setState({courier_geodata:{lat:this.state.courier_geodata.lat+1e-5,long:this.state.courier_geodata.long+1e-5}});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props;return n.a.createElement(v.n,{id:e.id},n.a.createElement(v.o,{left:n.a.createElement(R.a,{onClick:this.props.go,"data-to":"courier"},_e===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},e.order.shop),n.a.createElement(v.q,{disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:"",caption:e.order.date,after:e.order.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c"))},e.order.number),function(e,t){var a,r;return a="object"===typeof e?e.lat+","+e.long:e,r="object"===typeof t?t.lat+","+t.long:t,console.log(t),n.a.createElement(fe.d,{query:{apikey:"482da132-c4be-476f-95ef-79ba61d579a4",load:"control.ZoomControl"}},n.a.createElement(fe.a,{width:"100vw",height:"100vh",defaultState:Ee,className:"mapview"},n.a.createElement(fe.c,{instanceRef:function(e){e&&(e.routePanel.state.set({fromEnabled:!1,type:"masstransit",from:r,to:a,toEnabled:!1}),e.routePanel.options.set({allowSwitch:!1,reverseGeocoding:!0,types:{masstransit:!1,pedestrian:!1,taxi:!1}}))},options:{float:"right"}})))}(e.order.target,this.state.courier_geodata))}}]),a}(n.a.Component),ye={center:[55.751574,37.573856],zoom:9,controls:["zoomControl"]},je=Object(v.w)();var Oe=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={courier_id:-1,courier_geodata:{lat:55.6592,long:37.753314}},r.state.geoUpdateInterval=setInterval((function(){r.fetchCourierGeo()}),5e3),r}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,this.setState({courier_id:t.order.courier_id}),this.setState({courier_geodata:{lat:55.6592,long:37.753314}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchCourierGeo",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.courier_id>0&&this.setState({courier_geodata:{lat:this.state.courier_geodata.lat+1e-5,long:this.state.courier_geodata.long+1e-5}});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props;return n.a.createElement(v.n,{id:e.id},n.a.createElement(v.o,{left:n.a.createElement(R.a,{onClick:this.props.go,"data-to":"business"},je===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},e.order.shop),n.a.createElement(v.q,{disabled:!0,multiline:!0,before:n.a.createElement(v.c,{size:72}),text:e.order.courier_name,caption:e.order.date,after:e.order.state,actions:n.a.createElement(n.a.Fragment,null,n.a.createElement(v.d,null,"\u0427\u0430\u0442 \u0441 \u043a\u0443\u0440\u044c\u0435\u0440\u043e\u043c"))},e.order.number),function(e,t){var a,r;return a="object"===typeof e?e.lat+","+e.long:e,r="object"===typeof t?t.lat+","+t.long:t,console.log(t),n.a.createElement(fe.d,{query:{apikey:"482da132-c4be-476f-95ef-79ba61d579a4",load:"control.ZoomControl"}},n.a.createElement(fe.a,{width:"100vw",height:"100vh",defaultState:ye,className:"mapview"},n.a.createElement(fe.c,{instanceRef:function(e){e&&(e.routePanel.state.set({fromEnabled:!1,type:"masstransit",from:r,to:a,toEnabled:!1}),e.routePanel.options.set({allowSwitch:!1,reverseGeocoding:!0,types:{masstransit:!1,pedestrian:!1,taxi:!1}}))},options:{float:"right"}})))}(e.order.target,this.state.courier_geodata))}}]),a}(n.a.Component),Ce={center:[55.751574,37.573856],zoom:9,controls:["zoomControl"]},we=Object(v.w)();var Se=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;Object(h.a)(this,a),(r=t.call(this,e)).setYmaps=function(e){r.setState({ymaps:e})},r.setCenter=function(e){var t=r.state.ymaps;if(t){var a=e.getMap(),n=t.util.bounds.getCenterAndZoom(a.geoObjects.getBounds(),a.container.getSize()),o=n.zoom;n.zoom>19&&(o=19),a.setCenter(n.center,o)}};var n=r.fetchOrdersWithGeo(e.business_id);return r.state={business_id:e.business_id,orders:n,ymaps:null},r.state.geoUpdateInterval=setInterval((function(){r.setState({orders:r.fetchOrdersWithGeo(e.business_id)})}),5e3),r}return Object(m.a)(a,[{key:"fetchOrdersWithGeo",value:function(e){return this.state&&this.state.orders?(this.state.orders[0].geodata.lat=this.state.orders[0].geodata.lat+1e-4,this.state.orders[0].geodata.long=this.state.orders[0].geodata.long+1e-4,this.state.orders):[{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438"',date:"06.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"5488779",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:123,courier_name:"\u0418\u0432\u0430\u043d\u043e\u0432 \u0412\u0438\u043a\u0442\u043e\u0440",geodata:{lat:55.6592,long:37.753314}},{shop:'\u041c\u0430\u0433\u0430\u0437\u0438\u043d "\u0420\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0438\u0433\u0440\u0443\u0448\u043a\u0438"',date:"08.06.2020",state:"\u0412\u0435\u0437\u0443\u0442",number:"34643-643",target:"\u041c\u043e\u0441\u043a\u0432\u0430, \u0443\u043b. \u0411\u0440\u0430\u0442\u0438\u0441\u043b\u0430\u0432\u0441\u043a\u0430\u044f, \u0434. 31\u043a1",courier_id:124,courier_name:"\u0420\u0430\u0432\u0448\u0430\u043d \u0418\u043b\u044c\u044e\u0441\u043e\u0432\u0438\u0447",geodata:{lat:55.659209,long:37.753434}}]}},{key:"detailClick",value:function(){alert("test"),console.log("test")}},{key:"render",value:function(){var e=this;console.log("render");var t=this.props;return n.a.createElement(v.n,{id:t.id},n.a.createElement(v.o,{left:n.a.createElement(R.a,{onClick:this.props.go,"data-to":"business"},we===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},"\u041a\u0443\u0440\u044c\u0435\u0440\u044b ",t.business_name),n.a.createElement(fe.d,{query:{apikey:"482da132-c4be-476f-95ef-79ba61d579a4",load:["util.bounds","control.ZoomControl"]}},n.a.createElement(fe.a,{width:"100vw",height:"100vh",defaultState:Ce,className:"mapview",onLoad:function(t){return e.setYmaps(t)}},this.state.orders&&this.state.orders.map((function(t){return n.a.createElement(fe.b,{key:t.number,properties:{hintContent:t.courier_name,properties:{name:"test"},balloonContent:'<div style="margin: 10px;"><b>'+t.courier_name+"</b><br /> \u0417\u0430\u043a\u0430\u0437: "+t.number+'<br /><i id="count"></i> </div>'},modules:["geoObject.addon.balloon","geoObject.addon.hint"],geometry:[t.geodata.lat,t.geodata.long],instanceRef:function(t){return t&&e.setCenter(t)}})})))))}}]),a}(n.a.Component),xe=a(133),Pe=(a(293),Object(v.w)()),Ue=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={fetchedUser:null,email:"",purpose:""},r.onChange=r.onChange.bind(Object(p.a)(r)),r}return Object(m.a)(a,[{key:"onChange",value:function(e){var t=e.currentTarget,a=t.name,r=t.value;this.setState(Object(xe.a)({},a,r))}},{key:"buttonHandler",value:function(){alert("test!")}},{key:"render",value:function(){var e=this.props,t=this.state,a=t.email;t.purpose;return n.a.createElement(z.a,{id:e.id},n.a.createElement(T.a,{left:n.a.createElement(R.a,{onClick:e.go,"data-to":"business"},Pe===v.k?n.a.createElement(H.a,null):n.a.createElement($.a,null))},[e.business_name]),n.a.createElement(v.g,null,n.a.createElement(v.l,{type:"email",top:"E-mail",name:"email",value:a,onChange:this.onChange,status:a?"valid":"error",bottom:a?"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u0430 \u0432\u0435\u0440\u043d\u043e!":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443"}),n.a.createElement(v.l,{top:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d",keyboardType:"phone-pad",defaultValue:"+7 12 344 15 48"}),n.a.createElement(v.l,{top:"\u0410\u0434\u0440\u0435\u0441 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"}),n.a.createElement(v.u,{top:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"}),n.a.createElement(v.r,{top:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043a\u0443\u0440\u044c\u0435\u0440\u0430"},n.a.createElement("option",{value:"m"},"\u0418\u0432\u0430\u043d"),n.a.createElement("option",{value:"f"},"\u0412\u0430\u0441\u0438\u043b\u0438\u0439")),n.a.createElement(v.d,{size:"xl",onClick:this.buttonHandler},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u043a\u0430\u0437")))}}]),a}(n.a.Component),qe=window.location.hash.substr(1),ze=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).setLocation=function(e){"home"!==e?c.a.send("VKWebAppSetLocation",{location:e}):c.a.send("VKWebAppSetLocation",{location:""})},r.closePopout=function(){r.setState({popout:null,activePanel:"home"})},r.go=function(e,t){var a=e.currentTarget.dataset.to;r.fetchUser(a),"view_where_courier"===a&&r.setState({client_order:t}),"view_where_client"===a&&r.setState({courier_order:t}),"view_where_courier_for_business"===a&&r.setState({client_order_for_business:t}),r.setState({activePanel:a}),r.setLocation(a)},r.state={activePanel:~U.indexOf(qe)?qe:"home",fetchedUser:null,popout:n.a.createElement(E.a,{size:"large"}),activeStory:"main",client_order:null,courier_order:null,client_order_for_business:null,user:null},r.onStoryChange=r.onStoryChange.bind(Object(p.a)(r)),r}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,this.setState({fetchedUser:t,popout:null});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onStoryChange",value:function(e){this.setState({activeStory:e.currentTarget.dataset.story})}},{key:"fetchUser",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="https://sqsinformatique-vk-back.ngrok.io/api/v1/",e.t0=t,e.next="client"===e.t0?4:"courier"===e.t0?6:"business"===e.t0?8:10;break;case 4:return a+="clients/",e.abrupt("break",11);case 6:return a+="curiers/",e.abrupt("break",11);case 8:return a+="business/",e.abrupt("break",11);case 10:return e.abrupt("return",!0);case 11:return e.next=13,fetch(a+this.state.fetchedUser.id);case 13:if(!(r=e.sent).ok){e.next=20;break}return e.next=17,r.json();case 17:return o=e.sent,this.setState({user:o.result}),e.abrupt("return",!0);case 20:return this.setState({popout:n.a.createElement(he,{userType:t,fetchedUser:this.state.fetchedUser,closePopout:this.closePopout})}),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"tabbarByUserType",value:function(e){var t=null;switch(this.state.activePanel){case"client":t=n.a.createElement(v.s,null,n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"client_orders_ondelivery"===this.state.activeStory,"data-story":"client_orders_ondelivery",text:"\u041c\u043d\u0435 \u0432\u0435\u0437\u0443\u0442"},n.a.createElement(P.a,null)),n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"client_options"===this.state.activeStory,"data-story":"client_options",text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},n.a.createElement(S.a,null)));break;case"business":t=n.a.createElement(v.s,null,n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"main"===this.state.activeStory,"data-story":"main",text:"\u0417\u0430\u043a\u0430\u0437\u044b \u0432 \u0440\u0430\u0431\u043e\u0442\u0435"},n.a.createElement(k.a,null)),n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"business_couriers_onmap"===this.state.activeStory,"data-story":"business_couriers_onmap",text:"\u041a\u0443\u0440\u044c\u0435\u0440\u044b \u043d\u0430 \u043a\u0430\u0440\u0442\u0435"},n.a.createElement(j.a,null)),n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"business_add_order"===this.state.activeStory,"data-story":"business_add_order",text:"\u041d\u043e\u0432\u044b\u0439 \u0437\u0430\u043a\u0430\u0437"},n.a.createElement(C.a,null)),n.a.createElement(v.t,{onClick:this.onStoryChange,selected:"business_options"===this.state.activeStory,"data-story":"business_options",text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},n.a.createElement(S.a,null)))}return t}},{key:"render",value:function(){return n.a.createElement(v.f,{activeStory:this.state.activeStory,tabbar:this.tabbarByUserType(this.state.activePanel)},n.a.createElement(v.v,{id:"main",activePanel:this.state.activePanel,popout:this.state.popout},n.a.createElement(J,{id:"home",fetchedUser:this.state.fetchedUser,go:this.go}),n.a.createElement(oe,{id:"client",data:this.state.data,go:this.go}),n.a.createElement(pe,{id:"courier",go:this.go}),n.a.createElement(le,{id:"business",go:this.go}),n.a.createElement(ge,{id:"view_where_courier",order:this.state.client_order,go:this.go}),n.a.createElement(ke,{id:"view_where_client",order:this.state.courier_order,go:this.go}),n.a.createElement(Oe,{id:"view_where_courier_for_business",order:this.state.client_order_for_business,go:this.go})),n.a.createElement(v.v,{id:"business_couriers_onmap",activePanel:"business_couriers_onmap"},n.a.createElement(Se,{id:"business_couriers_onmap",business_id:"123",business_name:"\u041c\u0430\u0433\u0430\u0437\u0438\u043d \u0410\u0432\u0442\u043e\u0437\u0430\u043f\u0447\u0430\u0441\u0442\u0435\u0439",go:this.go})),n.a.createElement(v.v,{id:"business_add_order",activePanel:"business_add_order"},n.a.createElement(Ue,{id:"business_add_order",user:this.state.user,fetchedUser:this.state.fetchedUser,go:this.go})),n.a.createElement(v.v,{id:"business_options",activePanel:"business_options"},n.a.createElement(de,{id:"business_options",user:this.state.user,fetchedUser:this.state.fetchedUser,go:this.go})))}}]),a}(n.a.Component);c.a.send("VKWebAppInit"),s.a.render(n.a.createElement(ze,null),document.getElementById("root"))}},[[191,1,2]]]);
//# sourceMappingURL=main.3bda68f5.chunk.js.map